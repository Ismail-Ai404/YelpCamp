<!-- @format -->
<% layout("layouts/boilerplate") %>
<div id="campgroundMap" class="mt-0" style="height: 300px"></div>

<div class="container mt-4">
     <h1 class="mb-4 text-center">
          <i class="bi bi-tree-fill text-success"></i> All Campgrounds
     </h1>

     <% campgrounds.forEach(camp => { %>
     <div class="card mb-4 shadow-sm border-0 rounded-3 overflow-hidden">
          <div class="row g-0">
               <!-- Image -->
               <div class="col-md-4">
                    <img
                         src="<%= camp.images[0] ? camp.images[0].url : 'https://via.placeholder.com/600x400?text=No+Image' %>"
                         class="img-fluid h-100 w-100 object-fit-cover"
                         alt="<%= camp.title %>"
                    />
               </div>

               <!-- Content -->
               <div class="col-md-8">
                    <div class="card-body position-relative">
                         <!-- Price Badge -->
                         <% if (camp.price) { %>
                         <span
                              class="badge bg-success position-absolute top-0 end-0 m-2 fs-6 shadow-sm d-inline-flex justify-content-center align-items-center rounded-pill px-3"
                              style="min-width: 80px"
                         >
                              <i class="bi bi-cash-coin me-1"></i> $<%=
                              camp.price %>
                         </span>

                         <% } %>

                         <!-- Title -->
                         <h4 class="card-title mb-2 fw-bold">
                              <i class="bi bi-geo-alt-fill text-danger"></i>
                              <%= camp.title %>
                         </h4>

                         <!-- Description -->
                         <% if (camp.description) { %>
                         <p class="card-text text-muted">
                              <i class="bi bi-card-text"></i>
                              <%= camp.description.substring(0, 200) %>...
                         </p>
                         <% } %>

                         <!-- Location -->
                         <p class="card-text mb-3">
                              <i class="bi bi-geo-alt text-primary"></i>
                              <span class="fw-semibold"
                                   ><%= camp.location %></span
                              >
                         </p>

                         <!-- View Button -->
                         <a
                              href="/campgrounds/<%= camp._id %>"
                              class="btn btn-outline-primary px-4"
                         >
                              <i class="bi bi-eye-fill"></i> View Details
                         </a>
                    </div>
               </div>
          </div>
     </div>
     <% }) %>
</div>

<script>
     const mapToken = "<%= process.env.MAPTILER_API_KEY %>";

     const campgrounds= <%- JSON.stringify(campgrounds) %>;
</script>

<script src="/javascripts/campgroundMap.js"></script>
